(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216d34"],{c3b0:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",[i("CarparkFilter",{on:{change:t.onText,clicked:t.onFilter}}),i("v-list",[i("v-list-item-group",{attrs:{"active-class":"blue--text"}},[t._l(t.carparkItem,(function(e){return[i("v-list-item",{key:e.id},[[i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:t._s(e.carparkName)}}),i("v-list-item-subtitle",{domProps:{textContent:t._s(e.address)}})],1),i("v-list-item-action",["-1"!=e.totalAvailableLots?i("v-list-item-action-text",{domProps:{textContent:t._s(e.totalAvailableLots)}}):t._e(),0==e.favorite||void 0==e.favorite?i("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(i){return t.favorite(e)}}},[t._v("mdi-heart-outline")]):i("v-icon",{attrs:{color:"red"},on:{click:function(i){return t.unfavorite(e)}}},[t._v("mdi-heart")])],1)]],2)]})),i("infinite-loading",{ref:"InfiniteLoading",attrs:{spinner:"spiral",identifier:t.infiniteId},on:{infinite:t.infiniteHandler}},[i("div",{attrs:{slot:"no-more"},slot:"no-more"},[t._v("-- End of Carpark List --")]),i("div",{attrs:{slot:"no-results"},slot:"no-results"},[t._v("-- No Carpark --")])]),i("a",{staticClass:"btn btn-primary btn-lg back-to-top",attrs:{id:"back-to-top",href:"#",role:"button"}},[i("span",{staticClass:"fas fa-arrow-up"})])],2)],1)],1)},r=[],s=i("2b31"),n={components:{CarparkFilter:s["default"]},data(){return{carparkItem:[],infiniteId:+new Date,filterConfig:this.$store.getters.FILTER}},mounted:function(){this.filterConfig.PageNumber=1},methods:{onText(t){var e={SearchQuery:t};let i=this;this.axios.get("https://parkingslotapi.azurewebsites.net/api/carpark",{params:e}).then((function(t){i.carparkItem=Object.assign({},t.data)}))},onFilter(t){this.filterConfig=t,this.changeType()},infiniteHandler(t){this.axios.get("https://parkingslotapi.azurewebsites.net/api/carpark",{params:this.filterConfig}).then(({data:e})=>{setTimeout(()=>{e.length?(this.filterConfig.PageNumber+=1,this.carparkItem.push(...e),this.getUserFavorites(),t.loaded()):t.complete()},500)})},changeType(){this.filterConfig.PageNumber=1,this.carparkItem=[],this.infiniteId+=1},getUserFavorites:function(){this.$store.dispatch("GETFAVORITES").then(t=>{for(var e=0;e<t.data.length;e++){var i=t.data[e].carparkId,a=this.getCarparkPos(i);if(-1!=a){var r=this.carparkItem[a];r.favorite=!0,this.$set(this.carparkItem,a,r)}}})},getCarparkPos(t){var e=this.carparkItem.map((function(t){return t.id})).indexOf(t);return e},favorite:function(t){this.$store.dispatch("ADDFAVORITES",t.id).then(e=>{if(e){var i=this.getCarparkPos(t.id);t.favorite=!0,this.$set(this.carparkItem,i,t)}})},unfavorite:function(t){this.$store.dispatch("DELETEFAVORITE",t.id).then(e=>{if(e){var i=this.getCarparkPos(t.id);t.favorite=!1,this.$set(this.carparkItem,i,t)}})}}},o=n,l=i("2877"),c=i("6544"),p=i.n(c),f=i("b0af"),d=i("132d"),h=i("8860"),u=i("da13"),m=i("1800"),v=i("5d23"),k=i("1baa"),g=Object(l["a"])(o,a,r,!1,null,null,null);e["default"]=g.exports;p()(g,{VCard:f["a"],VIcon:d["a"],VList:h["a"],VListItem:u["a"],VListItemAction:m["a"],VListItemActionText:v["a"],VListItemContent:v["b"],VListItemGroup:k["a"],VListItemSubtitle:v["c"],VListItemTitle:v["d"]})}}]);
//# sourceMappingURL=chunk-2d216d34.1536e375.js.map